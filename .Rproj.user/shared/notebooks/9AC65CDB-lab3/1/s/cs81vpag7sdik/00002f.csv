"0","# Load necessary libraries"
"0","library(dplyr)"
"0","library(flextable)"
"0",""
"0","# Get the most recent date in the dataset"
"0","latest_date <- max(covid_pop_data$date, na.rm = TRUE)"
"0","start_date <- latest_date - 13  "
"0",""
"0","# Filter the dataset to include only the last 14 days"
"0","recent_data <- covid_pop_data %>%"
"0","  filter(date >= start_date & date <= latest_date)"
"0",""
"0","# Summarize total new cases per county over the last 14 days"
"0","summary_data <- recent_data %>%"
"0","  group_by(county) %>%  "
"0","  summarize("
"0","    total_new_cases = sum(new_cases, na.rm = TRUE),"
"0","    population = first(POPESTIMATE2021),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  mutate(new_cases_per_100k = (total_new_cases / population) * 100000)"
"0",""
"0","# Get the top 5 counties with the highest new cases per 100,000 residents"
"0","top_5_counties <- summary_data %>%"
"0","  arrange(desc(new_cases_per_100k)) %>%"
"0","  select(county, total_new_cases, new_cases_per_100k) %>%"
"0","  head(5)"
"0",""
"0","# Count the number of counties meeting the watch list condition"
"0","watch_list_count <- summary_data %>%"
"0","  filter(new_cases_per_100k > 100) %>%"
"0","  nrow()"
"0",""
"0","# Create a formatted table for top 5 counties"
"0","library(flextable)"
"0","table3 <- top_5_counties %>%"
"0","  flextable() %>%"
"0","  set_caption(""Top 5 Counties with Most New Cases Per 100,000 Residents in the Last 14 Days"")"
"0",""
"0","# Display the table"
"0","table3"
