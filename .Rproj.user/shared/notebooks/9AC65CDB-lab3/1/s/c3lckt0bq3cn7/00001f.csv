"0","# Load necessary libraries"
"0","library(tidyverse)"
"0","library(lubridate)"
"0","library(readr)"
"0","library(ggplot2)"
"0","library(patchwork)"
"0",""
"0","# Read COVID data (update path if needed)"
"0","covid_data <- read_csv(""data/covid_data.csv"")"
"0",""
"0","# Read county centroids data from provided URL"
"0","county_centroids <- read_csv(""https://raw.githubusercontent.com/mikejohnson51/csu-ess-330/refs/heads/main/resources/county-centroids.csv"")"
"0",""
"0","# Ensure column name consistency for merging"
"0","county_centroids <- county_centroids %>% rename(fips = fips)"
"0",""
"0","# Merge COVID data with county location data"
"0","covid_data <- covid_data %>%"
"0","  left_join(county_centroids, by = ""fips"")"
"0",""
"0","# Function to compute weighted mean center"
"0","compute_weighted_center <- function(data, weight_col) {"
"0","  data %>%"
"0","    group_by(date) %>%"
"0","    summarize("
"0","      Weighted_LON = sum(LON * .data[[weight_col]], na.rm = TRUE) / sum(.data[[weight_col]], na.rm = TRUE),"
"0","      Weighted_LAT = sum(LAT * .data[[weight_col]], na.rm = TRUE) / sum(.data[[weight_col]], na.rm = TRUE),"
"0","      total_weight = sum(.data[[weight_col]], na.rm = TRUE),"
"0","      month = format(first(date), ""%m"")  # Extract month"
"0","    )"
"0","}"
"0",""
"0","# Compute weighted mean centers for cases and deaths"
"0","weighted_cases <- compute_weighted_center(covid_data, ""cases"")"
"0","weighted_deaths <- compute_weighted_center(covid_data, ""deaths"")"
"0",""
"0","# Base map of USA states"
"0","usa_map <- borders(""state"", fill = ""gray90"", colour = ""white"")"
"0",""
"0","# Plot for COVID Cases"
"0","p1 <- ggplot() +"
"0","  usa_map +"
"0","  geom_point(data = weighted_cases, aes(x = Weighted_LON, y = Weighted_LAT, size = total_weight, color = ""Cases""), alpha = 0.7) +"
"0","  scale_size_continuous(range = c(2, 10)) +"
"0","  labs(title = ""Weighted Mean Center of COVID Cases"", x = ""Longitude"", y = ""Latitude"", color = ""Metric"") +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""bottom"") +"
"0","  scale_color_manual(values = ""red"")"
"0",""
"0","# Plot for COVID Deaths"
"0","p2 <- ggplot() +"
"0","  usa_map +"
"0","  geom_point(data = weighted_deaths, aes(x = Weighted_LON, y = Weighted_LAT, size = total_weight, color = ""Deaths""), alpha = 0.7) +"
"0","  scale_size_continuous(range = c(2, 10)) +"
"0","  labs(title = ""Weighted Mean Center of COVID Deaths"", x = ""Longitude"", y = ""Latitude"", color = ""Metric"") +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""bottom"") +"
"0","  scale_color_manual(values = ""navy"")"
"0",""
"0","# Combine plots side by side using patchwork"
"0","p1 + p2"
