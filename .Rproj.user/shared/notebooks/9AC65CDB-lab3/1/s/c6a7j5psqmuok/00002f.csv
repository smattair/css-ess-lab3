"0","# Load necessary libraries"
"0","library(tidyverse)"
"0","library(lubridate)"
"0","library(ggplot2)"
"0","library(readr)"
"0",""
"0","# Read in county centroid data and merge with COVID-19 data"
"0","county_centroids <- read_csv(""https://raw.githubusercontent.com/mikejohnson51/csu-ess-330/refs/heads/main/resources/county-centroids.csv"")"
"2","[1mRows: [22m[34m3221[39m [1mColumns: [22m[34m3[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (1): fips
[32mdbl[39m (2): LON, LAT"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","# Ensure the column names match for merging"
"0","county_centroids <- county_centroids %>%"
"0","  rename(fips = fips)  # Ensure consistent column name"
"0",""
"0","# Merge with COVID-19 data"
"0","covid_data <- covid_data %>%"
"0","  left_join(county_centroids, by = ""fips"") %>%"
"0","  select(date, county, state, fips, cases, deaths, LON.x, LAT.x) %>%  "
"0","  rename("
"0","    LON = LON.x,"
"0","    LAT = LAT.x"
"0","  )"
"0",""
"0","colnames(covid_data)  # Verify the column names"
"1","[1]"
"1"," ""date""  "
"1"," ""county"""
"1"," ""state"" "
"1"," ""fips""  "
"1"," ""cases"" "
"1"," ""deaths"""
"1","
"
"1","[7]"
"1"," ""LON""   "
"1"," ""LAT""   "
"1","
"
"0","# Compute the Weighted Mean Center for Each Date"
"0","weighted_mean_center <- covid_data %>%"
"0","  group_by(date) %>%"
"0","  summarize("
"0","    LON_WMC = sum(LON * cases, na.rm = TRUE) / sum(cases, na.rm = TRUE),"
"0","    LAT_WMC = sum(LAT * cases, na.rm = TRUE) / sum(cases, na.rm = TRUE),"
"0","    total_cases = sum(cases, na.rm = TRUE)"
"0","  ) %>%"
"0","  mutate(month = format(date, ""%m""))"
"0",""
"0","# Plot the Movement of the Weighted Mean Center"
"0","ggplot(weighted_mean_center, aes(x = LON_WMC, y = LAT_WMC, color = month, size = total_cases)) +"
"0","  borders(""state"", fill = ""gray90"", colour = ""white"") +"
"0","  geom_point(alpha = 0.8) +"
"0","  scale_size_continuous(range = c(2, 10)) +"
"0","  labs("
"0","    title = ""Weighted Mean Center of COVID-19 Cases in the USA"","
"0","    subtitle = ""Tracking the spread of the outbreak over time"","
"0","    x = ""Longitude"","
"0","    y = ""Latitude"","
"0","    color = ""Month"","
"0","    size = ""Total Cases"""
"0","  ) +"
"0","  theme_minimal()"
