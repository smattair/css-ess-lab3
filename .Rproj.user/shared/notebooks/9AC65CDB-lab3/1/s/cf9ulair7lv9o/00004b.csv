"0",""
"0","# Join with state population data to calculate per capita rates"
"0","state_pop <- covid_pop_data %>%"
"0","  select(state, POPESTIMATE2021) %>%"
"0","  distinct()"
"0",""
"0","state_data_per_capita <- state_data %>%"
"0","  left_join(state_pop, by = ""state"") %>%"
"0","  mutate(cases_per_100k = (daily_new_cases / POPESTIMATE2021) * 100000,"
"0","         rolling_avg_per_100k = rollmean(cases_per_100k, k = 7, fill = NA, align = ""right""))"
"0",""
"0","# Line plot for 7-day rolling per capita cases"
"0","ggplot(state_data_per_capita, aes(x = date, y = rolling_avg_per_100k, color = state)) +"
"0","  geom_line(size = 1.2) +"
"0","  labs(title = ""7-Day Rolling Average of COVID Cases Per 100,000 People"","
"0","       subtitle = ""Scaling by population allows fairer comparison"","
"0","       x = ""Date"","
"0","       y = ""New Cases per 100k"","
"0","       color = ""State"") +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""bottom"")"
